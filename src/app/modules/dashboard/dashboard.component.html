<div role="alert" [ngClass]="isNotificationVisible ? 'notification':'notification-hide'" #notification>
  <span>{{notificationMessage}}</span>
</div>
<div class="container fill">
  <div class="row fill shadow-lg p-3 mb-5 bg-white rounded">
    <div class="col-sm-4 chat-box-left">
      <div class="row chat-box-left-header">
        <div class="col-sm-12" style="height: 100%; ">
          <div class="row">
            <div class="col-12">
              <div *ngIf="isActiveFriendComponent">
                <span class="left-header-text">Hello {{currentUser.firstName + ' ' + currentUser.lastName}}</span>
              </div>
              <div *ngIf="isActiveFriendRequestComponent || isActiveAddFriendComponent">
                <div class="row">
                  <div class="col-6">
                    <input type="image" src="/assets/img/back.svg" style="width: 50px" (click)="showFriendComponent()"/>
                  </div>
                  <div class="row-6" style="margin: auto">
                    <span class="left-header-friend-request-text"
                          *ngIf="isActiveFriendRequestComponent">Friend requests</span>
                    <span class="left-header-friend-request-text"
                          *ngIf="isActiveAddFriendComponent">Invite new friend</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row chat-box-left-list">
        <div class="col-sm-12 friends-list-box" style=" height: 100%; overflow-y: auto;">
          <!-- Friend component-->
          <div *ngIf="isActiveFriendComponent && conversationList.length !== 0">
            <div *ngFor="let conversation of conversationList">
              <app-friend [conversation]="conversation"
                          [isNewMessage]="isNewMessage"
                          [onClickComponent]="clickFriendComponent"
                          (click)="enterConversation(conversation.id)"></app-friend>
            </div>
          </div>
          <div class="text-center" style="margin-top: 40%;"
               *ngIf="isActiveFriendComponent && conversationList.length === 0">
            <img src="/assets/img/friend_theme.svg" style="max-width: 75%">
            <br><br>
            <span style="font-size: 20px"><b>You don't have any friends</b></span>
          </div>
          <!-- -->
          <!-- Friend request component-->
          <div *ngIf="isActiveFriendRequestComponent && receivedFriendsRequest.length !== 0">
            <div *ngFor="let friendsRequest of receivedFriendsRequest">
              <app-friend-request [friendRequest]="friendsRequest"
                                  (friendsRequestReply)="onReplyFriendsRequest($event)"></app-friend-request>
            </div>
          </div>
          <div class="text-center" style="margin-top: 40%;"
               *ngIf="isActiveFriendRequestComponent && receivedFriendsRequest.length === 0">
            <img src="/assets/img/sad_blue.svg" style="max-width: 75%">
            <br><br>
            <span style="font-size: 20px"><b>No new requests</b></span>
            <br>
            <span>When people send you friend requests, they'll appear here.</span>
          </div>
          <!-- -->
          <!-- Add friend component-->
          <div *ngIf="isActiveAddFriendComponent">
            <div class="row">
              <div class="input-group mb-3" style="padding: 5px">
                <input type="text" class="form-control" style="height: 100%" placeholder="Friend code"
                       aria-label="Friend code" aria-describedby="basic-addon2" #friendCode>
                <div class="input-group-append">
                  <button class="btn btn-outline-secondary" type="button" (click)="sendFriendRequest()">Send</button>
                </div>
              </div>
            </div>
            <div *ngIf="isActiveAddFriendComponent && sentFriendsRequest.length !==0">
              <div *ngFor="let friendRequest of sentFriendsRequest">
                <app-add-friend [friendsRequest]="friendRequest"
                                (friendsRequestHasDeleted)="onDeletedFriendsRequest($event)"></app-add-friend>
              </div>
            </div>
            <div class="text-center" style="margin-top: 40%;"
                 *ngIf="isActiveAddFriendComponent && sentFriendsRequest.length === 0">
              <img src="/assets/img/empty_add_friend.svg" style="max-width: 75%">
              <br><br>
              <span style="font-size: 20px"><b>No sent friends request</b></span>
            </div>
          </div>
          <!-- -->
        </div>
      </div>
      <div class="row chat-box-buttons">
        <div class="col-sm-12">
          <div class="row" style="height: 100%">
            <div class="col-3 text-center" style=" margin: auto; width: 50%;">
              <input type="image" src="/assets/img/add_friend_ico.svg" style="width: 40px"
                     (click)="showAddFriendComponent()"/>
            </div>
            <div class="col-3 text-center" style=" margin: auto; width: 50%;">
              <input type="image" src="/assets/img/friends_ico.svg" style="width: 40px"
                     (click)="showFriendRequestComponent()"/>
            </div>
            <div class="col-3 text-center" style=" margin: auto; width: 50%;">
              <input type="image" src="/assets/img/setting_ico.svg" routerLink="/settings" style="width: 40px"/>
            </div>
            <div class="col-3 text-center" style=" margin: auto; width: 50%;">
              <input type="image" (click)="logout()" src="/assets/img/logout_ico.svg" style="width: 40px"/>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-8 chat-box-right">
      <div style="height: 7%;">
        <div class="row" style="background-color: #ffffff;border-radius: 10px; padding: 5px"
             *ngIf="currentConversation!==null">
          <div class="col-2 " style="margin: auto; text-align: right;">
            <img src="/assets/img/user_avatar.svg" alt="" style="max-width: 35px">
          </div>
          <div class="col-10" style="margin: auto; text-align: left">
            <span
              style="font-size: 20px;">{{currentConversation.recipient.firstName + ' ' + currentConversation.recipient.lastName}}</span>
          </div>
        </div>
      </div>
      <div class="row" style="height: 73%">
        <div class="col-sm-12 messages-container" #messageContainer (scroll)="onScrollMessages($event)">
          <div class="row" style="height: 100%" *ngIf="currentConversation === null">
            <div class="col-12 text-center" style=" margin: auto; width: 50%;">
              <img src="/assets/img/begin_chat.svg" alt="" style="max-width: 50%;">
              <br>
              <br>
              <span>Choice your friend and start chatting.</span>
            </div>
          </div>
          <div *ngIf="currentConversation !== null" style="height: 100%">
            <div *ngIf="messageList.length === 0" style="height: 100%">
              <div class="row" style="height: 100%">
                <div class="col-12 text-center" style=" margin: auto; width: 50%;">
                  <img src="/assets/img/no_message.svg" alt="" style="max-width: 50%;">
                  <br>
                  <span>Not found any message</span>
                </div>
              </div>
            </div>
            <div *ngIf="messageList.length !== 0">
              <div *ngFor="let message of messageList">
                <app-message [message]="message" (afterRenderMessage)="scrollChatMessage()" #appMessage></app-message>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row" style="height: 20%">
        <div class="col-sm-12" style=" height: 100%" *ngIf="currentConversation !== null">
          <div class="row" style="height: 100%; padding: 10px; margin: 0">
            <div class="input-group mb-3">
              <textarea class="form-control input-message" style="height: 100%;resize: none;"
                        placeholder="Type a message"
                        aria-label="Type a message" aria-describedby="basic-addon2" #inputMessage
                        (keyup.enter)="sentMessage()"></textarea>
              <div class="input-group-append">
                <button class="btn btn-outline-secondary" type="button" (click)="sentMessage()">Send</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
